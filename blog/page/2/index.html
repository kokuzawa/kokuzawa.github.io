<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.31" />

<link rel="alternate" type="application/rss+xml" title="RSS" href="https://kokuzawa.github.io/blog/index.xml">

<link rel="canonical" href="https://kokuzawa.github.io/blog/">


    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_dark.min.css">
    <title>Blogs - Katsumi Kokuzawa&#39;s Blog</title>
    
    <link href="https://kokuzawa.github.io/css/styles.css" rel="stylesheet">
    

  </head>

  <body>
    
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-36546771-1', 'auto');
ga('send', 'pageview');
</script>

    

    <header class="l-header">
      <nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://kokuzawa.github.io/">Katsumi Kokuzawa&#39;s Blog</a>
          </div>

          
          <div id="navbar" class="collapse navbar-collapse">
            
            <ul class="nav navbar-nav navbar-right">
              
              
              <li><a href="https://kokuzawa.github.io/about/">About</a></li>
              
              
            </ul>
            
          </div>
          

        </div>
      </nav>
    </header>

    <main>
      <div class="container">
        
<div class="row">
  <div class="col-md-8">

    
    <header class="page-header">
      <h1>Blogs</h1>
    </header>
    

    <ul class="p-articles">
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2016-02-28T01:56:31JST">Feb 28, 2016</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2016/02/28/intellij-ideakaradockershang-falsewildflydedebatugusuru/">IntelliJ IDEAからDocker上のWildFlyでデバッグする</a></h2>
  </header>

  
  <div class="summary">IntelliJ IDEAからDocker上のWildFlyコンテナにアプリケーションをデプロイし、 デバッグモードで起動することでステップ実行ができる環境を作ることが今回の目的です。 Docker上にコンテナを起動できる環境はできている前提になります。
環境  OS: Mac OSX 10.11.3 Java: Java&trade; SE Runtime Environment (build 1.8.0_60-b27) メモリ: 16GB Docker version 1.9.1  アプリの準備 どんなアプリでも良いのですが最終的な生成物はwarファイルにします。 今回はMavenプロジェクトで下記のようなフォルダ構成にします。
docker-wildfly-example/ ├── Dockerfile ├── container_settings.json ├── docker-wildfly-example.iml ├── pom.xml └── src └── main ├── java │ └── org │ └── katsumi │ └── HelloBean.java └── webapp ├── WEB-INF │ └── web.xml └── index.xhtml  肝心なDockerfileの内容は下記のようになります。
# WildFlyのイメージを取得 FROM jboss/wildfly:latest # MAINTAINER MAINTAINER Katsumi # アプリケーションのデプロイ COPY target/docker-wildfly-example.</div>

  
  <footer>
    <a href="https://kokuzawa.github.io/blog/2016/02/28/intellij-ideakaradockershang-falsewildflydedebatugusuru/" title="IntelliJ IDEAからDocker上のWildFlyでデバッグする">Read More…</a>
  </footer>
  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2016-02-12T23:53:41JST">Feb 12, 2016</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2016/02/12/apache-flex-kasutamuhetudadesekiyuriteiera/">Apache Flex カスタムヘッダでセキュリティエラー</a></h2>
  </header>

  
  <div class="summary">ちょっと前の話だけれども、 Apache Flex でHTTPリクエストを投げる際にカスタムヘッダを設定するとセキュリティエラーが発生するようになった。 詳細は下記。
https://bugbase.adobe.com/index.cfm?event=bug&amp;id=3759971</div>

  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2016-02-11T16:49:26JST">Feb 11, 2016</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2016/02/11/dockerdeshi-meruvmwoli-yong-sitakai-fa/">Dockerで始めるVMを利用した開発</a></h2>
  </header>

  
  <div class="summary">結構前からDockerの事を聞いていてそれは仮想化技術だと認識していました。 なんで今まで触ってこなかったのかというと仮想化環境を作るにはそれなりの マシンスペックが必要なのだろうと。つまり貧弱なマシンを使っている僕には関係ない。 自宅のMac Book Proが壊れて新しくなったり、 会社のPCのスペックが上がったりしたのでこれは触りどきかと思って今手をつけてみたわけです。 というわけでまさに触り始めなわけで開発まではたどり着いていません。タイトル嘘という方向で。
最初に何をしたかというと、DockerToolBoxというやつをインストールしました。 Homebrewでも入れられるみたいですがどこかのサイトにHomebrewで入れるとなかなか最新にならないよという 至極まっとうな記載があったのでひとまず最新がいいなあと思い、インストールモジュールをダウンロードしてみました。
これ、インストールすると目に見えて分かるのは３つのソフトがインストールされるということです。
 Docker Quickstart Terminal Kitematic (Beta) VirtualBox  もしかしたら見えないところに他のソフトがインストールされているのかもしれませんが、 まだよくわかっていません。
最初にDocker Quickstart Terminalを起動します。 これはOSXのターミナルが起動します。ここの中でCUIで操作するようです。 で、ちょっとハマったのは起動したターミナルに別タブを開いてそこでDockerの起動とかしようとしても 仮想マシンに接続できないようで理解するまで時間がかかりました。
Docker Quickstart Terminalを起動すると仮想マシンがdefaultという名前で起動します。 これはVirtualBoxを起動するとわかります。 今のところVirtualBoxを使って何かするということはなさそうだという理解です。 このdefaultの仮想マシンですが、間違ってログアウトしてしまったらログインのIDとパスワードがわからなくて難儀しました。 どうやらCore Linuxというものを使っているらしくそれのデフォルトのIDとパスワードでログインできるようです。 こういうDockerとは直接関係ない機能を試してみたくなるところが僕の悪いところで、 Dockerそのものをまだちゃんと触れていない状態です。
Kitematicはいろいろな人がアップしたDockerイメージが登録されているDockerHubというところへの アクセスをGUI経由でできるソフトのようです。 Dockerイメージとかもうよくわからないので、この本を買ってちゃんと勉強することにしました。
  
まだ最初の方しか読んでいませんが、 ざっくり言うとMavenみたいな感じですね！多分。
というわけでこれからしばらくはDockerを使ってみたいと思っています。</div>

  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-25T20:50:08JST">Dec 25, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2015/12/25/jdbcrealm-with-wildfly-9-dot-0-1-dot-final/">JdbcRealm with WildFly 9.0.1.Final</a></h2>
  </header>

  
  <div class="summary">以前、「WildFlyでJdbcRealm」 という記事を書きました。 これを現在インストールしている9.0.1.Final上で設定したところ、認証がうまく行われないことがわかりました。 大枠の変更はないのですが、DBに登録するパスワードのハッシュ文字列が当時とは異なる値である必要があったので、 忘れないようにメモしておきます。
差分 WildFly 8.0.0.Finalの時の設定:
&lt;security-domain name=&quot;app&quot; cache-type=&quot;default&quot;&gt; &lt;authentication&gt; &lt;login-module name=&quot;app_auth&quot; code=&quot;Database&quot; flag=&quot;required&quot;&gt; &lt;module-option name=&quot;dsJndiName&quot; value=&quot;java:jboss/datasources/ExampleDS&quot;/&gt; &lt;module-option name=&quot;principalsQuery&quot; value=&quot;SELECT PASSWORD FROM ACCOUNTS WHERE EMAIL = ?&quot;/&gt; &lt;module-option name=&quot;rolesQuery&quot; value=&quot;SELECT r.ROLENAME, 'Roles' FROM ROLES r, ACCOUNTS a WHERE r.ACCOUNTID = a.ACCOUNTID AND a.EMAIL = ?&quot;/&gt; &lt;module-option name=&quot;hashAlgorithm&quot; value=&quot;SHA-256&quot;/&gt; &lt;module-option name=&quot;hashEncoding&quot; value=&quot;HEX&quot;/&gt; &lt;/login-module&gt; &lt;/authentication&gt; &lt;/security-domain&gt;  WildFly 9.0.1.Finalの設定:
&lt;security-domain name=&quot;app&quot; cache-type=&quot;default&quot;&gt; &lt;authentication&gt; &lt;login-module name=&quot;app_auth&quot; code=&quot;Database&quot; flag=&quot;required&quot;&gt; &lt;module-option name=&quot;dsJndiName&quot; value=&quot;java:jboss/datasources/ExampleDS&quot;/&gt; &lt;module-option name=&quot;principalsQuery&quot; value=&quot;SELECT PASSWORD FROM ACCOUNTS WHERE EMAIL = ?</div>

  
  <footer>
    <a href="https://kokuzawa.github.io/blog/2015/12/25/jdbcrealm-with-wildfly-9-dot-0-1-dot-final/" title="JdbcRealm with WildFly 9.0.1.Final">Read More…</a>
  </footer>
  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-20T10:32:29JST">Dec 20, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2015/12/20/server-sent-events/">Server Sent Events</a></h2>
  </header>

  
  <div class="summary">これは JavaEE Advent Calendar 2015 の20日目の記事です。
昨日は@yumix_hさんの「「帰ってきたGlassFish Users Group Japan勉強会」の未発表資料」でした。
明日は@emaggameさんです。
Server Sent Eventsとは Server Sent Events (SSE) はサーバから送られたイベントという意味の通り、push型のデータ通信を行うことができます。 これはHTML5で追加された新機能です。 同じくpush型のデータ通信を行う方法としてWebsocketがありますが、WebsocketがHTTPとは別のプロトコルで通信をするのに対し、 SSEではHTTPプロトコルを利用します。そのため、既存のHTTPを利用した通信との互換性が高いというメリットがある反面、 Websocketのような双方向の通信を行うことはできません。 HTTPプロトコルでpush通信を実現するため、SSEではサーバからのレスポンスを受けても接続を終了せずに継続させます。 こうすることで、サーバ側からのデータを継続して受信することを実現します。 このようにSSEはHTTPプロトコルで接続を行うのですが、クライアントがSSEだと認識できるデータを送ってもらう必要があります。 そこで、サーバはMIMEタイプにtext/event-streamを設定する必要があります。
JavaEE8にSSEのサポートが入るようですが、一足先にJAX-RSのRIであるJerseyでこの機能を試すことができます。
Server Sent Eventsを試す 今回実行した環境は下記の通りです。
 OS: Mac OSX 10.11.1 Java: Java&trade; SE Runtime Environment (build 1.8.0_60-b27) APサーバ: GlasshFish-4.1.1 ブラウザ: Safari-9.0.1  実際のコードはGithubにあるので、 コードを見れば分かる方は以降の実装の説明を読むより、 そちらを見ていただいた方が早いかと思います。
sandbox/sse-example
実装の説明 Mavenを利用しているので、最初に下記のDependencyを追加します。 2015/12/10時点のMaven Centralの最新版は2.22.1のようです。
&lt;dependency&gt; &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt; &lt;artifactId&gt;jersey-media-sse&lt;/artifactId&gt; &lt;version&gt;2.22.1&lt;/version&gt; &lt;/dependency&gt;  サーバ側のリソースはMIMEタイプにtext/event-streamを設定する他に、 org.glassfish.jersey.media.sse.EventOutputを返却する必要があります。
@GET @Produces(SseFeature.SERVER_SENT_EVENTS) public EventOutput getServerSentEvents() { .</div>

  
  <footer>
    <a href="https://kokuzawa.github.io/blog/2015/12/20/server-sent-events/" title="Server Sent Events">Read More…</a>
  </footer>
  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-10T10:10:10JST">Dec 10, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2015/12/10/testfx/">JavaFXのUIをJUnit形式でテストする</a></h2>
  </header>

  
  <div class="summary">Java Advent Calendar 2015と JavaFX Advent Calendar 2015の10日目の記事です。
昨日は下記のお二人でした。
 Java Advent Calendarは@namihira_kさんの 「パフォーマンスを意識したJavaコーディング」 JavaFX Advent Calendarは@skrbさんの 「Interpolator で補間」  明日は下記のお二人です。
 Java Advent Calendarは@bitter_foxさん JavaFX Advent Calendarは@y_q1mさん  TestFXを知る 先月ダウンロードしたJava Magazine vol23に面白い記事が載っていました。 テストについて特集された中の、TestFXによるJavaFXのテストについての記事です。 TestFXはJavaFXのユーザ・インターフェースをJUnitベースでテストするためのAPIということで、 JUnitで書いたロジック通りにユーザ・インターフェースのテストが実施されます。 単純にロジックをなぞるだけではなく、実際にユーザ・インターフェースを操作した結果を判定してくれるようです。 これは、実際にテストを実行した際に、JavaFXのアプリ上でマウスカーソルが自動的に動いてボタンをクリックしたりすることからもわかります。
普段のプロジェクトでは、残念ながらJavaFXではなくFlexを使っているのですが、 ユーザ・インターフェース周りのテストの仕組みはあってもなかなか思ったようなテストができていないのが現実です。 TestFXはJUnitの延長上でテストができそうなので期待できそうです。
内容を説明する前に、実際に実行した際の動画を記録しました。 動画だと自動で動いているのかわからないと思いますが、 テスト起動後には何も操作をしていません。
 アプリの説明 テストに使ったアプリは、ラベルとボタンのあるシンプルなものです。 ボタンをクリックすることで、ラベルに「Hello World!」と表示します。
実際のコードは下記にあります。
https://github.com/kokuzawa/javafx-test
TestFXを設定 Mavenプロジェクトでは下記のDependencyを追加します。
&lt;dependency&gt; &lt;groupId&gt;org.loadui&lt;/groupId&gt; &lt;artifactId&gt;testFx&lt;/artifactId&gt; &lt;version&gt;3.1.2&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt;  テストを書く 対象のテストクラスは、TestFXを使うためにorg.loadui.testfx.GuiTestクラスを継承します。 org.loadui.testfx.GuiTestクラスはgetRootNode()メソッドを持ち、そのメソッドでテストしたい画面のFXMLをロードします。
package org.katsumi; import javafx.fxml.FXMLLoader; import javafx.scene.Node; import javafx.</div>

  
  <footer>
    <a href="https://kokuzawa.github.io/blog/2015/12/10/testfx/" title="JavaFXのUIをJUnit形式でテストする">Read More…</a>
  </footer>
  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-11-22T22:33:53JST">Nov 22, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2015/11/22/wildfly-swarmdeejbwoshi-su/">WildFly SwarmでEJBを試す</a></h2>
  </header>

  
  <div class="summary">WildFly Swarmを試すのも今日で３回目です。 だんだんと実装方法に慣れてきました。 この辺で当初の目的であったWildFly SwarmでEJBを使ってみたいと思います。 EJBが使えないのならSpring Bootで全然構わないわけで、 EJBが使えるかどうかはとても大事なところです。
EJBを組み込む EJBのモジュールを組み込みます。 よくよく考えてみると、EJBだけでは動きを確認するのが大変なので、 リクエストの受け口だけはJAXRSで作ります。 なので、JAXRSのモジュールも合わせて組み込みます。
また、JAXRSのリソースから@InjectでEJBをDIするにはWeldも必要です。 そのため、JAXRSのモジュールはwildfly-swarm-jaxrs-weldを利用することにします。
&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt; &lt;artifactId&gt;wildfly-swarm-jaxrs-weld&lt;/artifactId&gt; &lt;version&gt;1.0.0.Alpha5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt; &lt;artifactId&gt;wildfly-swarm-ejb&lt;/artifactId&gt; &lt;version&gt;1.0.0.Alpha5&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;  EJBを使ったアプリケーションを作る まずはEJBです。
package org.katsumi.ejb; import javax.ejb.Stateless; @Stateless public class HelloEjb { public String say() { return &quot;Hello!&quot;; } }  EJBを呼び出すRESTリソースです。
package org.katsumi.ejb; import javax.inject.Inject; import javax.ws.rs.GET; import javax.ws.rs.Path; @Path(&quot;/hello&quot;) public class HelloResource { @Inject private HelloEjb helloEjb; @GET public String hello() { return helloEjb.</div>

  
  <footer>
    <a href="https://kokuzawa.github.io/blog/2015/11/22/wildfly-swarmdeejbwoshi-su/" title="WildFly SwarmでEJBを試す">Read More…</a>
  </footer>
  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-11-16T22:58:09JST">Nov 16, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2015/11/16/wildfly-swarmdejsfwoshi-su/">WildFly SwarmでJSFを試す</a></h2>
  </header>

  
  <div class="summary">昨日はWildFly SwarmでJAXRSを触ったので、今日はJSFを試してみることにします。
JSFを組み込む 仕様毎にモジュールが分かれているので、JAXRSの時と同じく、今回はJSFのモジュールを取り込みます。 あと、ここで特に記載はしませんがwildfly-swarm-pluginももちろん設定する必要があります。
&lt;dependency&gt; &lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt; &lt;artifactId&gt;wildfly-swarm-jsf&lt;/artifactId&gt; &lt;version&gt;1.0.0.Alpha5&lt;/version&gt; &lt;/dependency&gt;  JSFアプリケーションを作る JSFアプリケーションを作ると言ってもJavaのコードを書くわけではなく、 動くことが分かれば良いのでXHTMLファイルだけを作るだけにします。
&lt;?xml version='1.0' encoding='UTF-8' ?&gt; &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt; &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xmlns:h=&quot;http://xmlns.jcp.org/jsf/html&quot;&gt; &lt;body&gt; &lt;h:outputText value=&quot;Hello JSF!&quot;/&gt; &lt;/body&gt; &lt;/html&gt;  あと、JAXRSの時と違い、web.xmlを作る必要があります。
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; version=&quot;3.1&quot;&gt; &lt;context-param&gt; &lt;param-name&gt;javax.faces.PROJECT_STAGE&lt;/param-name&gt; &lt;param-value&gt;Development&lt;/param-value&gt; &lt;/context-param&gt; &lt;servlet&gt; &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt; &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt; &lt;url-pattern&gt;*.xhtml&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;/web-app&gt;  動かす JAXRSの時と同じく、mainメソッドから実行するため、mainメソッドを持つクラスを作ります。 今回はJAXRSArchiveではなく、WARArchieをデプロイします。
package org.katsumi.jsf; import org.</div>

  
  <footer>
    <a href="https://kokuzawa.github.io/blog/2015/11/16/wildfly-swarmdejsfwoshi-su/" title="WildFly SwarmでJSFを試す">Read More…</a>
  </footer>
  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-11-14T16:08:44JST">Nov 14, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2015/11/14/wildfly-swarmdejaxrswoshi-su/">WildFly SwarmでJAXRSを試す</a></h2>
  </header>

  
  <div class="summary">WildFly Swarmのサイトにも記載されていますが、WildFly Swarmは自己完結型のJava microservicesを作成するのに役立つプロジェクトとのこと。 この分野だとSpring Bootの方が運用実績もあり、先行しているようですが、 将来的にはEJBも使いたいのでWildFly Swarmの方を使ってみます。 WildFly Swarmは一つのモジュールというわけではなく、JavaEEの仕様毎に複数のモジュールに分かれていて、 自分の必要なモジュールを取り込んで利用する形になるようです。
JAXRSを組み込む 今回は数あるモジュールの中からJAXRSのモジュールを利用してみます。 2015年11月時点での最新バージョンは1.0.0.Alpha5です。 pom.xmlに下記のdependencyを追加します。
&lt;dependency&gt; &lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt; &lt;artifactId&gt;wildfly-swarm-jaxrs&lt;/artifactId&gt; &lt;version&gt;1.0.0.Alpha5&lt;/version&gt; &lt;dependency&gt;  これを依存グラフで見てみると&hellip;依存がすごいです（笑）
JAXRSのモジュールを組み込んだだけではビルドしても実行できないので、 下記のpluginもpom.xmlに追加します。
&lt;plugin&gt; &lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt; &lt;artifactId&gt;wildfly-swarm-plugin&lt;/artifactId&gt; &lt;version&gt;1.0.0.Alpha5&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;package&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt;  JAXRSアプリケーションを作る WildFly Swarmの設定が一通り終わったので、次はJAXRSアプリケーションを作ります。 特別なことはなく、普通のJAXRSアプリケーションです。
package org.katsumi; import javax.ws.rs.ApplicationPath; import javax.ws.rs.core.Application; @ApplicationPath(&quot;/rest&quot;) public class MyApplication extends Application { }  package org.katsumi; import javax.ws.rs.GET; import javax.ws.rs.Path; @Path(&quot;/hello&quot;) public class HelloResource { @GET public String hello() { return &quot;Hello World!</div>

  
  <footer>
    <a href="https://kokuzawa.github.io/blog/2015/11/14/wildfly-swarmdejaxrswoshi-su/" title="WildFly SwarmでJAXRSを試す">Read More…</a>
  </footer>
  
</article>
</li>
      
      <li><article class="li">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-10-15T02:44:04JST">Oct 15, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kokuzawa.github.io/blog/">blog</a></li>
      
    </ul>
    <h2 class="title"><a href="https://kokuzawa.github.io/blog/2015/10/15/stream-in-jaxrs/">JAX-RSでStreamを扱う</a></h2>
  </header>

  
  <div class="summary">JAX-RSでExcelファイルをダウンロードする際にストリームを直接触る必要があって、 どうすればストリームにアクセスできるかちょっと調べてみました。 Excelファイルの生成にはApache POIを使っています。
Apache POIでExcelファイルを生成する場合、下記のようなコードを書きます。
final Workbook wb = new HSSFWorkbook(); final FileOutputStream fileOut = new FileOutputStream(&quot;workbook.xls&quot;); wb.write(fileOut); fileOut.close();  生成したファイルをファイルとして保存せずにServletでダウンロードしようとした場合、 そのコードは下記のようにHttpServletResponse#getOutputStream()でアウトプットストリームを取得し、 レスポンスボディに対してストリーミング処理をすることになります。
final Workbook wb = new HSSFWorkbook(); final FileOutputStream fileOut = new FileOutputStream(response.getOutputStream()); wb.write(fileOut); fileOut.close();  ここからが本題です。
JAX-RSでファイルをダウンロードするにはどうしたら良いのか。
通常のファイルの場合は下記のようなコードを書くことで実現できます。
final File file = new File(&quot;workbook.xls&quot;); return Response.ok(file).build();  Servletでのダウンロードのように、 レスポンスボディに対してストリーミング処理をする場合はjavax.ws.rs.core.StreamingOutputクラスを利用します。 そのコードは下記のようになります。
final Workbook wb = new HSSFWorkbook(); final StreamingOutput so = out -&gt; wb.write(out); return Response.ok(stream).build();  </div>

  
</article>
</li>
      
    </ul>

    
<nav>
  <ul class="pager">

    
    <li><a href="https://kokuzawa.github.io/blog/">Previous</a></li>
    

    
    <li><a href="https://kokuzawa.github.io/blog/page/3/">Next</a></li>
    

  </ul>
</nav>



  </div>
  <div class="col-md-4">
    
<aside class="l-sidebar">

  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">LATESTS</div>
    </div>
    <div class="list-group">
      
      <a href="https://kokuzawa.github.io/blog/2017/12/04/primefaces-dblclick/" class="list-group-item">PrimeFaces-6.1 Dblclick Event</a>
      
      <a href="https://kokuzawa.github.io/about/" class="list-group-item">About</a>
      
      <a href="https://kokuzawa.github.io/blog/2017/11/24/my-first-post/" class="list-group-item">Hugoで始めるブログ生活</a>
      
      <a href="https://kokuzawa.github.io/blog/2017/01/12/jsf-2-3-websocket/" class="list-group-item">JSF 2.3 の Websocket を試す</a>
      
      <a href="https://kokuzawa.github.io/blog/2016/12/28/primeng/" class="list-group-item">PrimeNGを組み込む</a>
      
      <a href="https://kokuzawa.github.io/blog/2016/12/28/intellij-ideaangular2/" class="list-group-item">IntelliJ IDEAでAngular2アプリを動かす</a>
      
      <a href="https://kokuzawa.github.io/blog/2016/12/25/opendialog-of-primefaces/" class="list-group-item">Dialog of PrimeFaces</a>
      
      <a href="https://kokuzawa.github.io/blog/2016/12/15/httpurlconnection/" class="list-group-item">HttpURLConnectionで嵌った話</a>
      
      <a href="https://kokuzawa.github.io/blog/2016/12/14/remotecommand-in-composite/" class="list-group-item">remoteCommand in Composite</a>
      
      <a href="https://kokuzawa.github.io/blog/2016/10/20/java-freemarker-noparse/" class="list-group-item">FreeMarkerでinterpolation部分をそのまま出力</a>
      
    </div>
  </section>

  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">CATEGORY</div>
    </div>
    <div class="list-group">
      
    </div>
  </section>
  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">TAG</div>
    </div>
    <div class="list-group">
      
      <a href="https://kokuzawa.github.io/tags/java" class="list-group-item">java</a>
      
      <a href="https://kokuzawa.github.io/tags/jsf" class="list-group-item">jsf</a>
      
      <a href="https://kokuzawa.github.io/tags/javaee" class="list-group-item">javaee</a>
      
      <a href="https://kokuzawa.github.io/tags/wildfly" class="list-group-item">wildfly</a>
      
      <a href="https://kokuzawa.github.io/tags/javafx" class="list-group-item">javafx</a>
      
      <a href="https://kokuzawa.github.io/tags/jax-rs" class="list-group-item">jax-rs</a>
      
      <a href="https://kokuzawa.github.io/tags/jpa" class="list-group-item">jpa</a>
      
      <a href="https://kokuzawa.github.io/tags/glassfish" class="list-group-item">glassfish</a>
      
      <a href="https://kokuzawa.github.io/tags/intellij-idea" class="list-group-item">intellij-idea</a>
      
      <a href="https://kokuzawa.github.io/tags/mac" class="list-group-item">mac</a>
      
    </div>
  </section>
  

</aside>


  </div>
</div>

      </div>
    </main>

    <footer class="l-footer">
      <div class="container">
        <p><span class="h-logo">&copy; Katsumi Kokuzawa&#39;s Blog</span></p>
        <aside>
          <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
          <p><a href="https://github.com/dim0627/hugo_theme_beg">Beg</a> designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>.</p>
        </aside>
      </div>
    </footer>

    <script src="//code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

